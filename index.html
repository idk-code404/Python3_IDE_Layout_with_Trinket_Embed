<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trinket with AI Assistant</title>
  <style>
    body {
      background: #0a0e14;
      color: #e6e6e6;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .window {
      background: #1f2430;
      border-radius: 12px;
      width: 80%;
      max-width: 900px;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
      margin-bottom: 20px;
    }
    .titlebar {
      background: #191d26;
      padding: 8px;
      display: flex;
      gap: 8px;
    }
    .dot {
      height: 12px; width: 12px; border-radius: 50%;
    }
    .red { background: #ff5f56; }
    .yellow { background: #ffbd2e; }
    .green { background: #27c93f; }

    iframe { width: 100%; height: 400px; border: none; }

    .assistant {
      background: #1f2430;
      border-radius: 12px;
      padding: 16px;
      width: 80%;
      max-width: 900px;
    }
    .assistant h2 {
      margin-top: 0;
    }
    .messages {
      height: 200px;
      overflow-y: auto;
      background: #0a0e14;
      border-radius: 8px;
      padding: 8px;
      margin-bottom: 12px;
    }
    .input-row {
      display: flex;
      gap: 8px;
    }
    input, button {
      padding: 8px;
      border-radius: 6px;
      border: none;
      font-family: monospace;
    }
    input { flex: 1; }
    button { background: #27c93f; color: black; cursor: pointer; }
  </style>
</head>
<body>
  <div class="window">
    <div class="titlebar">
      <div class="dot red"></div>
      <div class="dot yellow"></div>
      <div class="dot green"></div>
    </div>
    <iframe src="https://trinket.io/embed/python3/055c60f8a0"></iframe>
  </div>

  <div class="assistant">
    <h2>AI Assistant</h2>
    <div class="messages" id="messages"></div>
    <div class="input-row">
      <input type="password" id="adminCode" placeholder="Enter admin code first">
      <input type="text" id="userInput" placeholder="Type a message" disabled>
      <button id="sendBtn" disabled>Send</button>
    </div>
  </div>

  <script>
    const messagesEl = document.getElementById('messages');
    const adminInput = document.getElementById('adminCode');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    let unlocked = false;

    adminInput.addEventListener('change', () => {
      if (adminInput.value.trim() === "AI 27482328") {
        unlocked = true;
        adminInput.disabled = true;
        userInput.disabled = false;
        sendBtn.disabled = false;
        alert("✅ AI Assistant unlocked!");
      } else {
        alert("❌ Wrong admin code");
      }
    });

    function addMessage(sender, text) {
      const div = document.createElement('div');
      div.textContent = sender + ": " + text;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    sendBtn.addEventListener('click', async () => {
      const text = userInput.value.trim();
      if (!text) return;
      addMessage("You", text);
      userInput.value = "";

      // Call backend (replace /chat with your server endpoint)
      const res = await fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: text })
      });
      const data = await res.json();
      addMessage("AI", data.reply);
    });
  </script>
</body>
</html>
